(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{168:function(e,t,a){e.exports=a(363)},181:function(e,t,a){},363:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(98),i=a.n(l),s=a(369),o=a(370),c=a(367);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var m=a(368),u=a(155),d=a(6),p=a(3),h=a(77),v=a(58),E=(a(181),a(21)),g=a(22),b=a(24),y=a(23),f=a(25),w=a(8),O=a(31),j=a.n(O),k=a(49),x=a(371),N=a(15),S=a(14);function $(){var e=Object(N.a)(["\nmutation updateUser($username: String!, $email: String!, $token: String!) {\n  updateUser(username: $username, email: $email, token: $token) @client \n}\n"]);return $=function(){return e},e}function C(){var e=Object(N.a)(["\nquery {\n  theUser @client {\n        username\n        email\n        token\n}\n}\n"]);return C=function(){return e},e}function U(){var e=Object(N.a)(["\nquery($email: String!, $password: String!) {\n  nonAuthUser(email: $email, password: $password) {\n    id\n    email\n    username\n    token\n  }\n}\n"]);return U=function(){return e},e}function q(){var e=Object(N.a)(["\nmutation($username: String!, $password: String!, $email: String!) {\n  signUp(username: $username, password: $password, email: $email) {\n    id\n    username\n    email\n  }\n}\n"]);return q=function(){return e},e}function P(){var e=Object(N.a)(["\nquery($email: String!) {\n  userPost(email: $email) {\n    id\n    title\n    username\n    commentLength\n\n  }\n}\n"]);return P=function(){return e},e}function I(){var e=Object(N.a)(["\nmutation($id: ID!) {\n  removePost(id: $id){\n    title\n  }\n}\n"]);return I=function(){return e},e}function B(){var e=Object(N.a)(["\n  mutation($id: ID!, $username: String!, $comment: String!) {\n    addComment(id: $id, username: $username, comment: $comment){\n      id\n      commentLength\n      comments {\n        username\n        comment\n      }\n    }\n  }\n"]);return B=function(){return e},e}function L(){var e=Object(N.a)(["\n   query($id: ID!) {\n    post(id: $id){\n      id\n      title\n      body\n      username\n      email\n      comments {\n        username\n        comment\n      }\n    }\n  }\n"]);return L=function(){return e},e}function D(){var e=Object(N.a)(["\nmutation($title: String!, $body: String!, $email: String!, $username: String!, $date: String) {\n  addPost(title: $title, body: $body, email: $email, username: $username, date: $date) {\n    id\n    title\n    username\n    commentLength\n  }\n}\n"]);return D=function(){return e},e}function A(){var e=Object(N.a)(["\n{\n posts{\n    id\n    title\n    username\n    commentLength\n  }\n}\n"]);return A=function(){return e},e}function M(){var e=Object(N.a)(["\n{\n  getUser{\n    id\n    username\n    googleId\n    email\n  }\n}\n"]);return M=function(){return e},e}var Q=Object(S.a)(M()),V=Object(S.a)(A()),J=Object(S.a)(D()),T=Object(S.a)(L()),W=Object(S.a)(B()),_=Object(S.a)(I()),F=Object(S.a)(P()),R=Object(S.a)(q()),z=Object(S.a)(U()),G=Object(S.a)(C()),Y=Object(S.a)($()),H=r.a.createContext(),K=function(e){function t(){return Object(E.a)(this,t),Object(b.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(j.a.mark(function e(){var t,a,n;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("token"))){e.next=3;break}return e.abrupt("return");case 3:if(this.props.theUser){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,fetch("/authenticate",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(t)});case 7:return a=e.sent,e.next=10,a.json();case 10:if(n=e.sent,console.log(n),!n.message){e.next=17;break}return localStorage.removeItem("token"),this.props.changeUser({variables:{username:null,email:null,token:null}}),this.props.history.push("/user-signin"),e.abrupt("return");case 17:this.props.changeUser({variables:{username:t.username,email:t.email,token:t.token}});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(H.Provider,{value:this.props.user.getUser||this.props.theUser},this.props.children)}}]),t}(n.Component),X=Object(d.compose)(x.a,Object(d.graphql)(Q,{name:"user"}),Object(d.graphql)(G,{props:function(e){return{theUser:e.data.theUser}}}),Object(d.graphql)(Y,{name:"changeUser"}))(K),Z=a(366),ee=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).styles={nav:{backgroundColor:"#38435a !important"},button:{marginRight:"25px"}},a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(H.Consumer,null,function(t){return r.a.createElement("div",{className:"navbar-fixed"},r.a.createElement("nav",{className:"fixer"},r.a.createElement("div",{className:"nav-flex"},r.a.createElement(Z.a,{to:"/",className:"brand-logo left"},"Readitor"),e.isUser(t))))})}},{key:"isUser",value:function(e){return e.username?r.a.createElement(w.Dropdown,{trigger:r.a.createElement(w.Button,{className:"signbut",style:this.styles.button},e.username)},r.a.createElement(Z.a,{style:{color:"#26a69a"},to:"/user-posts"},"Check Posts"),this.signOut(e)):r.a.createElement(w.Dropdown,{trigger:r.a.createElement(w.Button,{className:"signbut",style:this.styles.button},"Sign In")},r.a.createElement(w.NavItem,{href:"http://localhost:5000/auth/google"},"Google+"),r.a.createElement("li",null,r.a.createElement(Z.a,{to:"/user-signup"},"Sign in")))}},{key:"signOut",value:function(e){var t=this;return e.googleId?r.a.createElement(w.NavItem,{href:"http://localhost:5000/auth/logout"},"Sign Out"):r.a.createElement(w.NavItem,{onClick:function(){localStorage.removeItem("token"),t.props.changeUser({variables:{username:null,email:null,token:null}})}},"Sign Out")}}]),t}(n.Component),te=Object(d.compose)(Object(d.graphql)(Y,{name:"changeUser"}))(ee),ae=a(75),ne=a.n(ae),re=a(163),le=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={body:""},a.handleExit=function(e){"keydown"===e.type?27===e.keyCode&&a.props.history.goBack():e.target.classList.value.includes("topmodal")&&a.props.history.goBack()},a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){document.body.addEventListener("keydown",this.handleExit),document.body.addEventListener("click",this.handleExit)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("keydown",this.handleExit),document.body.removeEventListener("click",this.handleExit)}},{key:"render",value:function(){var e=this;return r.a.createElement(H.Consumer,null,function(t){return r.a.createElement(d.Query,{query:T,variables:{id:e.props.match.params.id}},function(a){var n=a.loading,l=a.error,i=a.data;if(n)return r.a.createElement("div",{className:"topmodal"},r.a.createElement("div",{className:"modaldiv"},r.a.createElement("div",{className:"modalcontent"},r.a.createElement("h4",{style:{textAlign:"center"}},"Loading Post..."))));if(l)return"Error! ".concat(l.message);var s=i.post,o=s.title,c=s.body,m=s.comments,u=s.id,p=s.email,h=s.username;return r.a.createElement("div",{className:"topmodal"},r.a.createElement("div",{className:"modaldiv"},r.a.createElement("div",{className:"content1"},r.a.createElement("h4",null,o),r.a.createElement("span",{className:"smallertext"},"Posted by ",h),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"bodytext"},r.a.createElement("p",{className:"thebody"},c)),e.deletePost(t.email,p,u),r.a.createElement("div",{className:"divider"}),r.a.createElement(d.Mutation,{mutation:W},function(a,n){n.data;return r.a.createElement("form",{onSubmit:function(n){n.preventDefault();var r=t.username?t.username:"Anonymous";a({variables:{id:u,username:r,comment:e.state.body}}),e.setState({body:""})}},r.a.createElement("div",{className:"thecomment"},r.a.createElement("textarea",{type:"textarea",name:"body",id:"textarea1",className:"inputdiv materialize-textarea",placeholder:"What are your thoughts?",value:e.state.body,onChange:function(t){e.setState(Object(re.a)({},t.target.name,t.target.value))}}),r.a.createElement("label",{htmlFor:"textarea1"})),r.a.createElement(w.Button,{type:"submit",className:"mb"},"Comment"))}),r.a.createElement("div",{className:"divider"}),r.a.createElement("h5",null,"Comments ",r.a.createElement("small",null,m.length)),r.a.createElement("div",{className:"commentsdiv"},m.map(function(e){var t=e.username,a=e.comment;return r.a.createElement("div",{key:ne()(),className:"commentdiv"},r.a.createElement("span",{className:"smallertext"},r.a.createElement("strong",null,"Created by ",t)),r.a.createElement("p",{className:"comment"},a))})))))})})}},{key:"deletePost",value:function(e,t,a){var n=this;if(e)return e===t||"envdia@gmail.com"===e?r.a.createElement(d.Mutation,{mutation:_,refetchQueries:[{query:V}]},function(e,t){t.loading,t.error;return r.a.createElement("span",{className:"delete",onClick:Object(k.a)(j.a.mark(function t(){return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e({variables:{id:a}});case 2:n.props.history.goBack();case 3:case"end":return t.stop()}},t,this)}))},r.a.createElement("strong",{className:"deletecomment"},"Delete Post"))}):void 0}}]),t}(n.Component),ie=a(166),se=a(10),oe=a(13),ce=oe.object().shape({title:oe.string().required("Title is required"),body:oe.string().min(9,"Minimun 9 characters please").required("Body is required")}),me=function(e){return r.a.createElement(d.Mutation,{mutation:J,update:function(e,t){var a=t.data.addPost,n=e.readQuery({query:V}).posts;e.writeQuery({query:V,data:{posts:[a].concat(Object(ie.a)(n))}})}},function(t,a){a.data;return r.a.createElement(se.c,{initialValues:{title:"",body:""},onSubmit:function(a,n){var r=e.user.email?e.user.email:"Anonymous",l=e.user.username?e.user.username:"Anonymous";t({variables:{title:a.title,body:a.body,email:r,username:l,date:new Date}}),e.history.goBack()},validationSchema:ce,render:function(e){var t=e.values,a=e.touched,n=e.errors;return r.a.createElement(se.b,null,r.a.createElement("h4",null,"Create a post"),r.a.createElement("label",null,"Title",r.a.createElement("div",null,a.title&&n.title&&r.a.createElement("p",{style:{color:"red"}},n.title),r.a.createElement(se.a,{name:"title",type:"text",value:t.title}))),r.a.createElement("label",null,"Body",r.a.createElement("div",null,a.body&&n.body&&r.a.createElement("p",{style:{color:"red"}},n.body),r.a.createElement(se.a,{className:"materialize-textarea",name:"body",type:"text",value:t.body}))),r.a.createElement(w.Button,{type:"submit"},"Submit"),r.a.createElement(Z.a,{className:"waves-effect waves-light btn red lighten-1 ml-1",to:"/"},"Cancel"))}})})},ue=function(e){return r.a.createElement("div",{className:"topmodal"},r.a.createElement("div",{className:"modaldiv postcreator"},r.a.createElement("div",{className:"container makewhite mt-3"},r.a.createElement(H.Consumer,null,function(t){return r.a.createElement(me,{user:t,history:e.history})}))))},de=function(e){function t(){return Object(E.a)(this,t),Object(b.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(H.Consumer,null,function(t){return t?r.a.createElement(d.Query,{query:F,variables:{email:t.email}},function(t){var a=t.loading,n=(t.error,t.data);return a?"Loading...":r.a.createElement(r.a.Fragment,null,r.a.createElement(te,null),r.a.createElement(c.a,{path:"".concat(e.props.match.url,"/:id"),component:le}),r.a.createElement("div",{className:"contained"},r.a.createElement("h4",null,"Your Posts"),r.a.createElement(w.Collection,null,n.userPost.map(function(t){var a=t.id,n=t.title,l=t.username,i=t.commentLength,s="".concat(e.props.match.url,"/").concat(a);return r.a.createElement(Z.a,{to:s,key:a},r.a.createElement(w.CollectionItem,null,r.a.createElement("strong",null,n)," ",r.a.createElement("br",null),r.a.createElement("span",null,"Created by ",r.a.createElement("strong",null,l))," ",r.a.createElement("br",null),r.a.createElement("span",null,i>0?i:"0"," ",r.a.createElement("small",null,"Comments"))))}))))}):r.a.createElement("div",null,r.a.createElement(te,null),r.a.createElement("h2",null,"sign in please...."))})}}]),t}(n.Component),pe=oe.object().shape({email:oe.string().required("Email is required").email("Please enter a valid email"),username:oe.string().required("Username is required"),password:oe.string().required("Password is required").min(6)}),he=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(l)))).styles={loginparent:{position:"fixed",display:"flex",width:"100%",height:"100%"},logindiv:{width:"750px",margin:"45px auto auto auto"},logininfo:{display:"flex",flexDirection:"column"}},a.state={isValid:!1},a.handleSign=function(){var e=a.state.isValid;return e&&!e.signUp.id?r.a.createElement("h5",{style:{color:"red"}},"Email is already being used..."):e&&e.signUp.id?(setTimeout(function(){a.props.history.push("/user-signin")},1500),r.a.createElement("h5",null,"Success!")):void 0},a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(te,null),r.a.createElement("div",{className:"loginparent",style:this.styles.loginparent},r.a.createElement("div",{className:"logindiv",style:this.styles.logindiv},r.a.createElement("div",{className:"logininfo",style:this.styles.logininfo},r.a.createElement(Z.a,{to:"/user-signin",style:{marginBottom:"45px",color:"green"}},"Already a user? Click here to sign in."),r.a.createElement(d.Mutation,{mutation:R,onCompleted:function(t){e.setState({isValid:t})}},function(t,a){a.data;return r.a.createElement(se.c,{initialValues:{username:"",password:"",email:""},onSubmit:function(e,a){t({variables:{email:e.email,username:e.username,password:e.password}})},validationSchema:pe,render:function(t){var a=t.values,n=t.touched,l=t.errors;return r.a.createElement(se.b,null,e.handleSign(),r.a.createElement("div",null,r.a.createElement("label",null,"Email",r.a.createElement("div",null,n.email&&l.email&&r.a.createElement("p",{style:{color:"red"}},l.email),r.a.createElement(se.a,{name:"email",type:"text",values:a.email})))),r.a.createElement("div",null,r.a.createElement("label",null,"Username",n.username&&l.username&&r.a.createElement("p",{style:{color:"red"}},l.username),r.a.createElement(se.a,{name:"username",type:"text",values:a.username}))),r.a.createElement("div",null,r.a.createElement("label",null,"Password",n.password&&l.password&&r.a.createElement("p",{style:{color:"red"}},l.password),r.a.createElement(se.a,{name:"password",type:"text",values:a.password}))),r.a.createElement(w.Button,{type:"submit"},"Sign Up"))}})})))))}}]),t}(n.Component),ve=oe.object().shape({email:oe.string().required("Email is required").email("Please enter a valid email"),password:oe.string().required("Password is required").min(6)}),Ee=Object(d.compose)(Object(d.graphql)(Y,{name:"changeUser"}))(function(e){var t={loginparent:{position:"fixed",display:"flex",width:"100%",height:"100%"},logindiv:{width:"750px",margin:"45px auto auto auto"},logininfo:{display:"flex",flexDirection:"column"}};return r.a.createElement("div",null,r.a.createElement(te,null),r.a.createElement("div",{className:"loginparent",style:t.loginparent},r.a.createElement("div",{className:"logindiv",style:t.logindiv},r.a.createElement("div",{className:"logininfo",style:t.logininfo},r.a.createElement(d.ApolloConsumer,null,function(t){return r.a.createElement(se.c,{initialValues:{email:"",password:""},validationSchema:ve,onSubmit:function(){var a=Object(k.a)(j.a.mark(function a(n,r){var l,i,s,o;return j.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.query({query:z,variables:{email:n.email,password:n.password}});case 2:if(l=a.sent,(i=l.data).nonAuthUser){a.next=7;break}return r.setFieldError("password","Invalid password"),a.abrupt("return");case 7:s=i.nonAuthUser,o=JSON.stringify(s),localStorage.setItem("token",o),e.changeUser({variables:{username:s.username,email:s.email,token:s.token}}),e.history.push("/");case 12:case"end":return a.stop()}},a,this)}));return function(e,t){return a.apply(this,arguments)}}(),render:function(e){var t=e.values,a=e.touched,n=e.errors;return r.a.createElement(se.b,null,r.a.createElement("label",null,"Email",a.email&&n.email&&r.a.createElement("p",{style:{color:"red"}},n.email),r.a.createElement(se.a,{type:"text",name:"email",value:t.email})),r.a.createElement("label",null,"Password",a.password&&n.password&&r.a.createElement("p",{style:{color:"red"}},n.password),r.a.createElement(se.a,{id:"password",type:"password",name:"password",value:t.password})),r.a.createElement(w.Button,{type:"submit"},"Sign in"))}})})))))}),ge=new m.a,be=Object(v.b)({uri:"/graph"}),ye=Object(h.a)({cache:ge,defaults:{theUser:{__typename:"CurrentUser",username:null,email:null,token:null}},resolvers:{Mutation:{updateUser:function(e,t,a){var n=a.cache;return t.__typename="CurrentUser",n.writeData({data:{theUser:t}}),null}}}}),fe=new u.a({cache:ge,link:p.a.from([ye,be])});i.a.render(r.a.createElement(d.ApolloProvider,{client:fe},r.a.createElement(s.a,null,r.a.createElement(X,null,r.a.createElement(o.a,null,r.a.createElement(c.a,{exact:!0,path:"/user-signup",component:he}),r.a.createElement(c.a,{exact:!0,path:"/user-signin",component:Ee}),r.a.createElement(c.a,{path:"/user-posts",component:de}),r.a.createElement(c.a,{path:"/",component:function(e){return r.a.createElement(d.Query,{query:V},function(e){var t=e.loading,a=e.error,n=e.data;return t?"Loading...":a?"Error! ".concat(a.message):r.a.createElement("div",null,r.a.createElement(te,null),r.a.createElement(c.a,{path:"/posts/:id",component:le}),r.a.createElement(c.a,{path:"/create-post",component:ue}),r.a.createElement("div",{className:"contained"},r.a.createElement("h4",null,"Recent Posts"),r.a.createElement(Z.a,{className:"waves-effect waves-light btn",to:"/create-post"},"Create Post"),r.a.createElement("div",{className:"comments"},r.a.createElement(w.Collection,null,n.posts.map(function(e){var t=e.title,a=e.username,n=e.commentLength,l=e.id,i="/posts/".concat(l);return r.a.createElement(Z.a,{to:i,key:ne()()},r.a.createElement(w.CollectionItem,null,r.a.createElement("strong",null,t)," ",r.a.createElement("br",null),r.a.createElement("span",null,"Created by ",r.a.createElement("strong",null,a))," ",r.a.createElement("br",null),r.a.createElement("span",null,n>0?n:"0"," ",r.a.createElement("small",null,"Comments"))))})))))})}}))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[168,2,1]]]);
//# sourceMappingURL=main.0fb457a4.chunk.js.map